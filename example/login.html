<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OIDC Client Example</title>
    <script type="module">


        const cognitoAuthConfig = {
            authority: "https://cognito-idp.eu-central-1.amazonaws.com/eu-central-1_URSR8f3hq",
            client_id: "32k4dockapjb94ebc76rggq26t",
            redirect_uri: "https://api-dev.cirqit.cloud/oauth2/token",
            response_type: "code",
            scope: "email openid profile"
        };

        // // create a UserManager instance
        // const userManager = new UserManager({
        //     ...cognitoAuthConfig,
        // });
        export async function signOutRedirect() {
            const clientId = "32k4dockapjb94ebc76rggq26t";
            const logoutUri = "<logout uri>";
            const cognitoDomain = "https://cirqit-dev-auth-344019372375.auth.eu-central-1.amazoncognito.com";
            window.location.href = `${cognitoDomain}/logout?client_id=${clientId}&logout_uri=${encodeURIComponent(logoutUri)}`;
        }


        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("signIn").addEventListener("click", async () => {
                const cognitoDomain = "https://cirqit-dev-auth-344019372375.auth.eu-central-1.amazoncognito.com";
                const clientId = "32k4dockapjb94ebc76rggq26t";
                const authUrl = `${cognitoDomain}/login?client_id=${clientId}&response_type=token&scope=email+openid+profile&redirect_uri=https://api-dev.cirqit.cloud/oauth2/token?`;

                try {
                    const response = await fetch(authUrl, {
                        method: 'GET',
                        redirect: 'manual'
                    });

                    if (response.status === 302) {
                        const redirectUrl = response.headers.get('Location');
                        if (redirectUrl) {
                            // Handle the redirect URL as needed
                            console.log('Redirect URL:', redirectUrl);
                            // You can now fetch the redirect URL or manipulate it as needed
                        } else {
                            console.error('Redirect URL not found');
                        }
                    } else if (response.status === 200) {
                        console.error('expected  response status:', response.status, response);
                        const htmlContent = await response.text();
                        document.getElementById('content').innerHTML = htmlContent;
                    }else {
                        console.error('Unexpected response status:', response.status);
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            });
        });
    </script>
</head>
<body>
<div>
    <button id="signIn">Sign In</button>
</div>
<div>
    Hello: <pre id="email"></pre>
    Access token: <pre id="access-token"></pre>
    ID token: <pre id="id-token"></pre>
    Refresh token: <pre id="refresh-token"></pre>
</div>
<div id="content">
    <!-- HTML content will be displayed here -->
</div>
</body>
</html>
